"0","#Tuning Cross Sectional R Squared SKELETON CODE"
"0","#We want individual r squared for each stock to be 50%"
"0","#We want individual annualized volatility to be 30%"
"0","#We want to cross sectional R squared to be 25%"
"0","#We want the predictive R squared to be 5%"
"0","#Generate paramaters first"
"0","#Tune v_sd for inidividual r square first"
"0","#Gu et al had 0.05 for their v variance"
"0","v_sd <- 0.05"
"0","#Tune SV parameters for individual r square first"
"0","#Not too sure about stochastic volatility parameters"
"0","  # #Defaults"
"0","  # omega <- -0.736"
"0","  # gamma <- 0.90"
"0","  # w <- sqrt(0.363)"
"0","#theta <- matrix(c(0.02, 0.02, 0.02), nrow = 1)"
"0","#rt<- g1(C,x,theta)+resid"
"0","##########################################"
"0","# Time series R-squared"
"0","##########################################"
"0","  Rsquared<-matrix(0,N,1)"
"0","  SSR<-matrix(0,N,1)"
"0","  SST<-matrix(0,N,1)"
"0","  Fits<-matrix(0,(Time+1),N)"
"0","  Coeff_Betas<-matrix(0,N,3)"
"0","  Xs_bar<-matrix(0,N,3)"
"0","  R_bar<-matrix(0,N,1)"
"0","  Resids<-matrix(0,(Time+1),N)"
"0","  for (i in 1:N)"
"0","{"
"0","  Rs<- rt[i,]"
"0","  R_bar[i,1]<-mean(Rs)"
"0","  Xs<- cbind(t(C[i,1:2,]),(as.matrix(C[i,3,]*as.matrix(x[,1]))))"
"0","  Xs_bar[i,]<- colMeans(Xs)"
"0","  df<-data.frame(Rs,Xs)"
"0","  fit<-lm(Rs ~., df)"
"0","  Fits[,i]<- fit$fitted.values"
"0","  Coeff_Betas[i,]<-as.numeric(fit$coefficients[2:4])"
"0","  Resids[,i]<- fit$residuals"
"0","  SSR[i,1]<- sum(Resids[,i]^2)"
"0","  SST[i,1]<- sum((Rs-mean(Rs))^2)"
"0","  "
"0","  "
"0","  Rsquared[i,1]<-summary(fit)$r.squared"
"0","  "
"0","  }"
"0","mean(Rsquared)"
"1","[1]"
"1"," 0.03422111"
"1","
"
"0","val<-g1(C,x,theta)"
"0","true_res<- rowSums( (rt - val)^2)"
"0","true_sst<- rowSums((rt-rowMeans(rt))^2)"
"0","true_rRsquared <- 1-(sum(true_res)/sum(true_sst))"
"0","fitted_Rsquared<- 1-(sum(SSR)/sum(SST))"
"0","##########################################"
"0","# Cross-sectional R-squared"
"0","##########################################"
"0","R_bar <- rowMeans(rt)"
"0","df_new <- data.frame(R_bar,Coeff_Betas) "
"0","cross_fit <- lm(R_bar~ Coeff_Betas, df_new) "
"0","summary(cross_fit)"
"1","
Call:
"
"1","lm(formula = R_bar ~ Coeff_Betas, data = df_new)"
"1","

"
"1","Residuals:
"
"1","       Min "
"1","        1Q "
"1","    Median "
"1","        3Q "
"1","       Max "
"1","
"
"1","-0.0081217 "
"1","-0.0020264 "
"1","-0.0001295 "
"1"," 0.0021004 "
"1"," 0.0091083 "
"1","
"
"1","
Coefficients:
"
"1","            "
"1","   Estimate"
"1"," Std. Error"
"1"," t value"
"1"," Pr(>|t|)"
"1","    "
"1","
(Intercept) "
"1"," -0.0329764"
"1","  0.0005149"
"1"," -64.039"
"1","   <2e-16"
"1"," ***"
"1","
Coeff_Betas1"
"1"," -0.0012383"
"1","  0.0010518"
"1","  -1.177"
"1","    0.241"
"1","    "
"1","
Coeff_Betas2"
"1"," -0.0004131"
"1","  0.0011806"
"1","  -0.350"
"1","    0.727"
"1","    "
"1","
Coeff_Betas3"
"1","  0.0097304"
"1","  0.0202369"
"1","   0.481"
"1","    0.631"
"1","    "
"1","
"
"1","---
Signif. codes:  "
"1","0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1"
"1","
"
"1","
Residual standard error:"
"1"," "
"1","0.00339"
"1"," "
"1","on"
"1"," "
"1","196"
"1"," "
"1","degrees of freedom"
"1","
"
"1","Multiple R-squared: "
"1"," "
"1","0.009964"
"1",",	Adjusted R-squared: "
"1"," "
"1","-0.00519"
"1"," "
"1","
F-statistic:"
"1"," "
"1","0.6575"
"1"," "
"1","on"
"1"," "
"1","3"
"1"," "
"1","and"
"1"," "
"1","196"
"1"," "
"1","DF,  p-value:"
"1"," "
"1","0.5791"
"1","
"
"1","
"
