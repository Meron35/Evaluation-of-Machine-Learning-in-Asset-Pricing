g2_A1_sv_0.1 <- readRDS("~/GitHub/Evaluation-of-Machine-Learning-in-Asset-Pricing/R/Simulated_dataset/g2_A1_sv_0.1.RDS")
g3_A1_sv_0.1 <- readRDS("~/GitHub/Evaluation-of-Machine-Learning-in-Asset-Pricing/R/Simulated_dataset/g3_A1_sv_0.1.RDS")
g2_A1_sv_0.1_LSTM_results_15 <- fit_all_models_lstm(g2_A1_sv_0.1, batch_process_range)
knitr::opts_chunk$set(echo = TRUE)
################
##Load Libraries
################
library(tidyverse)
library(keras)
library(quantreg)
library(ggplot2)
library(forecast)
library(rlist)
library(Metrics)
library(ranger)
library(caret)
library(forcats)
library(xtable)
library(randomForestSRC)
library(xts)
library(uwot)
library(rugarch)
#Parallel Computing
library(foreach)
library(doFuture)
#Registering
registerDoFuture()
plan(multisession)
set.seed(27935248)
g2_A1_sv_0.1 <- readRDS("~/GitHub/Evaluation-of-Machine-Learning-in-Asset-Pricing/R/Simulated_dataset/g2_A1_sv_0.1.RDS")
g3_A1_sv_0.1 <- readRDS("~/GitHub/Evaluation-of-Machine-Learning-in-Asset-Pricing/R/Simulated_dataset/g3_A1_sv_0.1.RDS")
g2_A1_sv_0.1_LSTM_results_15 <- fit_all_models_lstm(g2_A1_sv_0.1, batch_process_range)
saveRDS(g2_A1_sv_0.1_LSTM_results_15, "~/GitHub/Evaluation-of-Machine-Learning-in-Asset-Pricing/R/Model_results/g2_A1_sv_0.1_LSTM_results_15.rds")
g3_A1_sv_0.1_LSTM_results_15 <- fit_all_models_lstm(g3_A1_sv_0.1, batch_process_range)
saveRDS(g3_A1_sv_0.1_LSTM_results_15, "~/GitHub/Evaluation-of-Machine-Learning-in-Asset-Pricing/R/Model_results/g3_A1_sv_0.1_LSTM_results_15.rds")
knitr::opts_chunk$set(echo = TRUE)
################
##Load Libraries
################
library(tidyverse)
library(keras)
library(quantreg)
library(ggplot2)
library(forecast)
library(rlist)
library(Metrics)
library(ranger)
library(caret)
library(forcats)
library(xtable)
library(randomForestSRC)
library(xts)
library(uwot)
library(rugarch)
#Parallel Computing
library(foreach)
library(doFuture)
#Registering
registerDoFuture()
plan(multisession)
set.seed(27935248)
g3_A1_sv_1 <- readRDS("~/GitHub/Evaluation-of-Machine-Learning-in-Asset-Pricing/R/Simulated_dataset/g3_A1_sv_1.RDS")
g3_A1_sv_1_LSTM_results_15 <- fit_all_models_lstm(g3_A1_sv_1, batch_process_range)
saveRDS(g3_A1_sv_1_LSTM_results_15, "~/GitHub/Evaluation-of-Machine-Learning-in-Asset-Pricing/R/Model_results/g3_A1_sv_1_LSTM_results_15.rds")
knitr::opts_chunk$set(echo = TRUE)
################
##Load Libraries
################
library(tidyverse)
library(keras)
library(quantreg)
library(ggplot2)
library(forecast)
library(rlist)
library(Metrics)
library(ranger)
library(caret)
library(forcats)
library(xtable)
library(randomForestSRC)
library(xts)
library(uwot)
library(rugarch)
#Parallel Computing
library(foreach)
library(doFuture)
#Registering
registerDoFuture()
plan(multisession)
set.seed(27935248)
g1_A1_nosv_0_LSTM_results15 <- readRDS("~/GitHub/Evaluation-of-Machine-Learning-in-Asset-Pricing/R/Model_results/g1_A1_nosv_0_LSTM_results15.RDS")
g1_A1_nosv_0_LSTM_results_15 <- readRDS("~/GitHub/Evaluation-of-Machine-Learning-in-Asset-Pricing/R/Model_results/g1_A1_nosv_0_LSTM_results_15.RDS")
g2_A1_nosv_0_LSTM_results_15 <- readRDS("~/GitHub/Evaluation-of-Machine-Learning-in-Asset-Pricing/R/Model_results/g2_A1_nosv_0_LSTM_results_15.RDS")
g3_A1_nosv_0_LSTM_results_15 <- readRDS("~/GitHub/Evaluation-of-Machine-Learning-in-Asset-Pricing/R/Model_results/g3_A1_nosv_0_LSTM_results_15.RDS")
g1_A1_sv_0.01_LSTM_results_15 <- readRDS("~/GitHub/Evaluation-of-Machine-Learning-in-Asset-Pricing/R/Model_results/g1_A1_sv_0.01_LSTM_results_15.RDS")
g2_A1_sv_0.01_LSTM_results_15 <- readRDS("~/GitHub/Evaluation-of-Machine-Learning-in-Asset-Pricing/R/Model_results/g2_A1_sv_0.01_LSTM_results_15.RDS")
g3_A1_sv_0.01_LSTM_results_15 <- readRDS("~/GitHub/Evaluation-of-Machine-Learning-in-Asset-Pricing/R/Model_results/g3_A1_sv_0.01_LSTM_results_15.RDS")
g1_A1_sv_0.1_LSTM_results_15 <- readRDS("~/GitHub/Evaluation-of-Machine-Learning-in-Asset-Pricing/R/Model_results/g1_A1_sv_0.1_LSTM_results_15.RDS")
g2_A1_sv_0.1_LSTM_results_15 <- readRDS("~/GitHub/Evaluation-of-Machine-Learning-in-Asset-Pricing/R/Model_results/g2_A1_sv_0.1_LSTM_results_15.RDS")
g3_A1_sv_0.1_LSTM_results_15 <- readRDS("~/GitHub/Evaluation-of-Machine-Learning-in-Asset-Pricing/R/Model_results/g3_A1_sv_0.1_LSTM_results_15.RDS")
g1_A1_sv_1_LSTM_results_15 <- readRDS("~/GitHub/Evaluation-of-Machine-Learning-in-Asset-Pricing/R/Model_results/g1_A1_sv_1_LSTM_results_15.RDS")
g2_A1_sv_1_LSTM_results_15 <- readRDS("~/GitHub/Evaluation-of-Machine-Learning-in-Asset-Pricing/R/Model_results/g2_A1_sv_1_LSTM_results_15.RDS")
g3_A1_sv_1_LSTM_results_15 <- readRDS("~/GitHub/Evaluation-of-Machine-Learning-in-Asset-Pricing/R/Model_results/g3_A1_sv_1_LSTM_results_15.RDS")
g1_A1_nosv_0_LSTM_results_610 <- readRDS("~/GitHub/Evaluation-of-Machine-Learning-in-Asset-Pricing/R/Model_results/g1_A1_nosv_0_LSTM_results_610.RDS")
combine_LSTM_results_list <- function(normal_list, lstm15_list, lstm_610_list) {
for (i in 1:5) {
normal_list[[i]]$LSTM_MSE <- lstm15_list[[i]]$LSTM_MSE
normal_list[[i]]$LSTM_MAE <- lstm15_list[[i]]$LSTM_MAE
}
## Coment 6-10 for now
# for (i in 6:10) {
#   normal_list[[i]]$LSTM_MSE <- lstm610_list[[i]]$LSTM_MSE
#   normal_list[[i]]$LSTM_MAE <- lstm610_list[[i]]$LSTM_MAE
# }
normal_list
}
g1_A1_nosv_0_FFORMA_results <- readRDS("~/GitHub/Evaluation-of-Machine-Learning-in-Asset-Pricing/R/Model_results/g1_A1_nosv_0_FFORMA_results.RDS")
g2_A1_nosv_0_FFORMA_results <- readRDS("~/GitHub/Evaluation-of-Machine-Learning-in-Asset-Pricing/R/Model_results/g2_A1_nosv_0_FFORMA_results.RDS")
g3_A1_nosv_0_FFORMA_results <- readRDS("~/GitHub/Evaluation-of-Machine-Learning-in-Asset-Pricing/R/Model_results/g3_A1_nosv_0_FFORMA_results.RDS")
g1_A1_sv_0.01_FFORMA_results <- readRDS("~/GitHub/Evaluation-of-Machine-Learning-in-Asset-Pricing/R/Model_results/g1_A1_sv_0.01_FFORMA_results.RDS")
g2_A1_sv_0.01_FFORMA_results <- readRDS("~/GitHub/Evaluation-of-Machine-Learning-in-Asset-Pricing/R/Model_results/g2_A1_sv_0.01_FFORMA_results.RDS")
g3_A1_sv_0.01_FFORMA_results <- readRDS("~/GitHub/Evaluation-of-Machine-Learning-in-Asset-Pricing/R/Model_results/g3_A1_sv_0.01_FFORMA_results.RDS")
g1_A1_sv_0.1_FFORMA_results <- readRDS("~/GitHub/Evaluation-of-Machine-Learning-in-Asset-Pricing/R/Model_results/g1_A1_sv_0.1_FFORMA_results.RDS")
g2_A1_sv_0.1_FFORMA_results <- readRDS("~/GitHub/Evaluation-of-Machine-Learning-in-Asset-Pricing/R/Model_results/g2_A1_sv_0.1_FFORMA_results.RDS")
g3_A1_sv_0.1_FFORMA_results <- readRDS("~/GitHub/Evaluation-of-Machine-Learning-in-Asset-Pricing/R/Model_results/g3_A1_sv_0.1_FFORMA_results.RDS")
g1_A1_sv_1_FFORMA_results <- readRDS("~/GitHub/Evaluation-of-Machine-Learning-in-Asset-Pricing/R/Model_results/g1_A1_sv_1_FFORMA_results.RDS")
g2_A1_sv_1_FFORMA_results <- readRDS("~/GitHub/Evaluation-of-Machine-Learning-in-Asset-Pricing/R/Model_results/g2_A1_sv_1_FFORMA_results.RDS")
g3_A1_sv_1_FFORMA_results <- readRDS("~/GitHub/Evaluation-of-Machine-Learning-in-Asset-Pricing/R/Model_results/g3_A1_sv_1_FFORMA_results.RDS")
## Chunk to load all results lists
g1_A1_nosv_0_results <- readRDS("~/GitHub/Evaluation-of-Machine-Learning-in-Asset-Pricing/R/Model_results/g1_A1_nosv_0_results.RDS")
g2_A1_nosv_0_results <- readRDS("~/GitHub/Evaluation-of-Machine-Learning-in-Asset-Pricing/R/Model_results/g2_A1_nosv_0_results.RDS")
g3_A1_nosv_0_results <- readRDS("~/GitHub/Evaluation-of-Machine-Learning-in-Asset-Pricing/R/Model_results/g3_A1_nosv_0_results.RDS")
g1_A1_sv_0.01_results <- readRDS("~/GitHub/Evaluation-of-Machine-Learning-in-Asset-Pricing/R/Model_results/g1_A1_sv_0.01_results.RDS")
g2_A1_sv_0.01_results <- readRDS("~/GitHub/Evaluation-of-Machine-Learning-in-Asset-Pricing/R/Model_results/g2_A1_sv_0.01_results.RDS")
g3_A1_sv_0.01_results <- readRDS("~/GitHub/Evaluation-of-Machine-Learning-in-Asset-Pricing/R/Model_results/g3_A1_sv_0.01_results.RDS")
g1_A1_sv_0.1_results <- readRDS("~/GitHub/Evaluation-of-Machine-Learning-in-Asset-Pricing/R/Model_results/g1_A1_sv_0.1_results.RDS")
g2_A1_sv_0.1_results <- readRDS("~/GitHub/Evaluation-of-Machine-Learning-in-Asset-Pricing/R/Model_results/g2_A1_sv_0.1_results.RDS")
g3_A1_sv_0.1_results <- readRDS("~/GitHub/Evaluation-of-Machine-Learning-in-Asset-Pricing/R/Model_results/g3_A1_sv_0.1_results.RDS")
g1_A1_sv_1_results <- readRDS("~/GitHub/Evaluation-of-Machine-Learning-in-Asset-Pricing/R/Model_results/g1_A1_sv_1_results.RDS")
g2_A1_sv_1_results <- readRDS("~/GitHub/Evaluation-of-Machine-Learning-in-Asset-Pricing/R/Model_results/g2_A1_sv_1_results.RDS")
g3_A1_sv_1_results <- readRDS("~/GitHub/Evaluation-of-Machine-Learning-in-Asset-Pricing/R/Model_results/g3_A1_sv_1_results.RDS")
####################################################################################################################
## Random Forests
g1_A1_nosv_0_RF_results <- readRDS("~/GitHub/Evaluation-of-Machine-Learning-in-Asset-Pricing/R/Model_results/g1_A1_nosv_0_RF_results.RDS")
g2_A1_nosv_0_RF_results <- readRDS("~/GitHub/Evaluation-of-Machine-Learning-in-Asset-Pricing/R/Model_results/g2_A1_nosv_0_RF_results.RDS")
g3_A1_nosv_0_RF_results <- readRDS("~/GitHub/Evaluation-of-Machine-Learning-in-Asset-Pricing/R/Model_results/g3_A1_nosv_0_RF_results.RDS")
g1_A1_sv_0.01_RF_results <- readRDS("~/GitHub/Evaluation-of-Machine-Learning-in-Asset-Pricing/R/Model_results/g1_A1_sv_0.01_RF_results.RDS")
g2_A1_sv_0.01_RF_results <- readRDS("~/GitHub/Evaluation-of-Machine-Learning-in-Asset-Pricing/R/Model_results/g2_A1_sv_0.01_RF_results.RDS")
g3_A1_sv_0.01_RF_results <- readRDS("~/GitHub/Evaluation-of-Machine-Learning-in-Asset-Pricing/R/Model_results/g3_A1_sv_0.01_RF_results.RDS")
g1_A1_sv_0.1_RF_results <- readRDS("~/GitHub/Evaluation-of-Machine-Learning-in-Asset-Pricing/R/Model_results/g1_A1_sv_0.1_RF_results.RDS")
g2_A1_sv_0.1_RF_results <- readRDS("~/GitHub/Evaluation-of-Machine-Learning-in-Asset-Pricing/R/Model_results/g2_A1_sv_0.1_RF_results.RDS")
g3_A1_sv_0.1_RF_results <- readRDS("~/GitHub/Evaluation-of-Machine-Learning-in-Asset-Pricing/R/Model_results/g3_A1_sv_0.1_RF_results.RDS")
g1_A1_sv_1_RF_results <- readRDS("~/GitHub/Evaluation-of-Machine-Learning-in-Asset-Pricing/R/Model_results/g1_A1_sv_1_RF_results.RDS")
g2_A1_sv_1_RF_results <- readRDS("~/GitHub/Evaluation-of-Machine-Learning-in-Asset-Pricing/R/Model_results/g2_A1_sv_1_RF_results.RDS")
g3_A1_sv_1_RF_results <- readRDS("~/GitHub/Evaluation-of-Machine-Learning-in-Asset-Pricing/R/Model_results/g3_A1_sv_1_RF_results.RDS")
####################################################################################################################
## MLP Results
g1_A1_nosv_0_NN_results15 <- readRDS("~/GitHub/Evaluation-of-Machine-Learning-in-Asset-Pricing/R/Model_results/g1_A1_nosv_0_NN_results15.RDS")
g2_A1_nosv_0_NN_results15 <- readRDS("~/GitHub/Evaluation-of-Machine-Learning-in-Asset-Pricing/R/Model_results/g2_A1_nosv_0_NN_results15.RDS")
g3_A1_nosv_0_NN_results15 <- readRDS("~/GitHub/Evaluation-of-Machine-Learning-in-Asset-Pricing/R/Model_results/g3_A1_nosv_0_NN_results15.RDS")
g1_A1_sv_0.01_NN_results15 <- readRDS("~/GitHub/Evaluation-of-Machine-Learning-in-Asset-Pricing/R/Model_results/g1_A1_sv_0.01_NN_results15.RDS")
g2_A1_sv_0.01_NN_results15 <- readRDS("~/GitHub/Evaluation-of-Machine-Learning-in-Asset-Pricing/R/Model_results/g2_A1_sv_0.01_NN_results15.RDS")
g3_A1_sv_0.01_NN_results15 <- readRDS("~/GitHub/Evaluation-of-Machine-Learning-in-Asset-Pricing/R/Model_results/g3_A1_sv_0.01_NN_results15.RDS")
g1_A1_sv_0.1_NN_results15 <- readRDS("~/GitHub/Evaluation-of-Machine-Learning-in-Asset-Pricing/R/Model_results/g1_A1_sv_0.1_NN_results15.RDS")
g2_A1_sv_0.1_NN_results15 <- readRDS("~/GitHub/Evaluation-of-Machine-Learning-in-Asset-Pricing/R/Model_results/g2_A1_sv_0.1_NN_results15.RDS")
g3_A1_sv_0.1_NN_results15 <- readRDS("~/GitHub/Evaluation-of-Machine-Learning-in-Asset-Pricing/R/Model_results/g3_A1_sv_0.1_NN_results15.RDS")
g1_A1_sv_1_NN_results15 <- readRDS("~/GitHub/Evaluation-of-Machine-Learning-in-Asset-Pricing/R/Model_results/g1_A1_sv_1_NN_results15.RDS")
g2_A1_sv_1_NN_results15 <- readRDS("~/GitHub/Evaluation-of-Machine-Learning-in-Asset-Pricing/R/Model_results/g2_A1_sv_1_NN_results15.RDS")
g3_A1_sv_1_NN_results15 <- readRDS("~/GitHub/Evaluation-of-Machine-Learning-in-Asset-Pricing/R/Model_results/g3_A1_sv_1_NN_results15.RDS")
##
g1_A1_nosv_0_NN_results610 <- readRDS("~/GitHub/Evaluation-of-Machine-Learning-in-Asset-Pricing/R/Model_results/g1_A1_nosv_0_NN_results610.RDS")
g2_A1_nosv_0_NN_results610 <- readRDS("~/GitHub/Evaluation-of-Machine-Learning-in-Asset-Pricing/R/Model_results/g2_A1_nosv_0_NN_results610.RDS")
g3_A1_nosv_0_NN_results610 <- readRDS("~/GitHub/Evaluation-of-Machine-Learning-in-Asset-Pricing/R/Model_results/g3_A1_nosv_0_NN_results610.RDS")
g1_A1_sv_0.01_NN_results610 <- readRDS("~/GitHub/Evaluation-of-Machine-Learning-in-Asset-Pricing/R/Model_results/g1_A1_sv_0.01_NN_results610.RDS")
g2_A1_sv_0.01_NN_results610 <- readRDS("~/GitHub/Evaluation-of-Machine-Learning-in-Asset-Pricing/R/Model_results/g2_A1_sv_0.01_NN_results610.RDS")
g3_A1_sv_0.01_NN_results610 <- readRDS("~/GitHub/Evaluation-of-Machine-Learning-in-Asset-Pricing/R/Model_results/g3_A1_sv_0.01_NN_results610.RDS")
g1_A1_sv_0.1_NN_results610 <- readRDS("~/GitHub/Evaluation-of-Machine-Learning-in-Asset-Pricing/R/Model_results/g1_A1_sv_0.1_NN_results610.RDS")
g2_A1_sv_0.1_NN_results610 <- readRDS("~/GitHub/Evaluation-of-Machine-Learning-in-Asset-Pricing/R/Model_results/g2_A1_sv_0.1_NN_results610.RDS")
g3_A1_sv_0.1_NN_results610 <- readRDS("~/GitHub/Evaluation-of-Machine-Learning-in-Asset-Pricing/R/Model_results/g3_A1_sv_0.1_NN_results610.RDS")
g1_A1_sv_1_NN_results610 <- readRDS("~/GitHub/Evaluation-of-Machine-Learning-in-Asset-Pricing/R/Model_results/g1_A1_sv_1_NN_results610.RDS")
g2_A1_sv_1_NN_results610 <- readRDS("~/GitHub/Evaluation-of-Machine-Learning-in-Asset-Pricing/R/Model_results/g2_A1_sv_1_NN_results610.RDS")
g3_A1_sv_1_NN_results610 <- readRDS("~/GitHub/Evaluation-of-Machine-Learning-in-Asset-Pricing/R/Model_results/g3_A1_sv_1_NN_results610.RDS")
combine_RF_results_list <- function(normal_list, RF_list) {
for(i in 1:10) {
normal_list[[i]]$RF_MSE <- RF_list[[i]]$RF_MSE
normal_list[[i]]$RF_MAE <- RF_list[[i]]$RF_MAE
}
normal_list
}
combine_NN_results_list <- function(normal_list, nn15_list, nn610_list) {
for(i in 1:5) {
normal_list[[i]]$NN1_MSE <- nn15_list[[i]]$NN1_MSE
normal_list[[i]]$NN1_MAE <- nn15_list[[i]]$NN1_MAE
normal_list[[i]]$NN2_MSE <- nn15_list[[i]]$NN2_MSE
normal_list[[i]]$NN2_MAE <- nn15_list[[i]]$NN2_MAE
normal_list[[i]]$NN3_MSE <- nn15_list[[i]]$NN3_MSE
normal_list[[i]]$NN3_MAE <- nn15_list[[i]]$NN3_MAE
normal_list[[i]]$NN4_MSE <- nn15_list[[i]]$NN4_MSE
normal_list[[i]]$NN4_MAE <- nn15_list[[i]]$NN4_MAE
normal_list[[i]]$NN5_MSE <- nn15_list[[i]]$NN5_MSE
normal_list[[i]]$NN5_MAE <- nn15_list[[i]]$NN5_MAE
}
for(i in 6:10) {
normal_list[[i]]$NN1_MSE <- nn610_list[[i]]$NN1_MSE
normal_list[[i]]$NN1_MAE <- nn610_list[[i]]$NN1_MAE
normal_list[[i]]$NN2_MSE <- nn610_list[[i]]$NN2_MSE
normal_list[[i]]$NN2_MAE <- nn610_list[[i]]$NN2_MAE
normal_list[[i]]$NN3_MSE <- nn610_list[[i]]$NN3_MSE
normal_list[[i]]$NN3_MAE <- nn610_list[[i]]$NN3_MAE
normal_list[[i]]$NN4_MSE <- nn610_list[[i]]$NN4_MSE
normal_list[[i]]$NN4_MAE <- nn610_list[[i]]$NN4_MAE
normal_list[[i]]$NN5_MSE <- nn610_list[[i]]$NN5_MSE
normal_list[[i]]$NN5_MAE <- nn610_list[[i]]$NN5_MAE
}
normal_list
}
combine_LSTM_results_list <- function(normal_list, lstm15_list, lstm_610_list) {
for (i in 1:5) {
normal_list[[i]]$LSTM_MSE <- lstm15_list[[i]]$LSTM_MSE
normal_list[[i]]$LSTM_MAE <- lstm15_list[[i]]$LSTM_MAE
}
## Coment 6-10 for now
# for (i in 6:10) {
#   normal_list[[i]]$LSTM_MSE <- lstm610_list[[i]]$LSTM_MSE
#   normal_list[[i]]$LSTM_MAE <- lstm610_list[[i]]$LSTM_MAE
# }
normal_list
}
## Combining FFORMA Results
combine_FFORMA_results_list <- function(normal_list, fforma_list) {
for(i in 1:10) {
normal_list[[i]]$FFORMA_MSE <- fforma_list[[i]]$FFORMA_MSE
normal_list[[i]]$FFORMA_MAE <- fforma_list[[i]]$FFORMA_MAE
normal_list[[i]]$FFORMA_MSE <- fforma_list[[i]]$FFORMA_MSE
normal_list[[i]]$FFORMA_MAE <- fforma_list[[i]]$FFORMA_MAE
normal_list[[i]]$FFORMA_MSE <- fforma_list[[i]]$FFORMA_MSE
normal_list[[i]]$FFORMA_MAE <- fforma_list[[i]]$FFORMA_MAE
normal_list[[i]]$FFORMA_MSE <- fforma_list[[i]]$FFORMA_MSE
normal_list[[i]]$FFORMA_MAE <- fforma_list[[i]]$FFORMA_MAE
normal_list[[i]]$FFORMA_MSE <- fforma_list[[i]]$FFORMA_MSE
normal_list[[i]]$FFORMA_MAE <- fforma_list[[i]]$FFORMA_MAE
}
normal_list
}
combine_DeepAR_results_list <- function(normal_list, deepar_list) {
for(i in 1:10) {
normal_list[[i]]$DeepAR <- deepar_list[[i]]$DeepAR_MSE
}
normal_list
}
## nosv_0
g1_A1_nosv_0_results_all <- g1_A1_nosv_0_results %>%
combine_RF_results_list(g1_A1_nosv_0_RF_results) %>%
combine_NN_results_list(g1_A1_nosv_0_NN_results15, g1_A1_nosv_0_NN_results610) %>%
combine_LSTM_results_list(g1_A1_nosv_0_LSTM_results_15, 0) %>%
combine_FFORMA_results_list(g1_A1_nosv_0_FFORMA_results)
## nosv_0
g1_A1_nosv_0_results_all <- g1_A1_nosv_0_results %>%
combine_RF_results_list(g1_A1_nosv_0_RF_results) %>%
combine_NN_results_list(g1_A1_nosv_0_NN_results15, g1_A1_nosv_0_NN_results610) %>%
combine_LSTM_results_list(g1_A1_nosv_0_LSTM_results_15, 0) %>%
combine_FFORMA_results_list(g1_A1_nosv_0_FFORMA_results)
g2_A1_nosv_0_results_all <- g2_A1_nosv_0_results %>%
combine_RF_results_list(g2_A1_nosv_0_RF_results) %>%
combine_NN_results_list(g2_A1_nosv_0_NN_results15, g2_A1_nosv_0_NN_results610) %>%
combine_LSTM_results_list(g2_A1_nosv_0_LSTM_results_15, 0) %>%
combine_FFORMA_results_list(g2_A1_nosv_0_FFORMA_results)
g3_A1_nosv_0_results_all <- g3_A1_nosv_0_results %>%
combine_RF_results_list(g3_A1_nosv_0_RF_results) %>%
combine_NN_results_list(g3_A1_nosv_0_NN_results15, g3_A1_nosv_0_NN_results610) %>%
combine_LSTM_results_list(g3_A1_nosv_0_LSTM_results_15, 0) %>%
combine_FFORMA_results_list(g3_A1_nosv_0_FFORMA_results)
## sv_0.01
g1_A1_sv_0.01_results_all <- g1_A1_sv_0.01_results %>%
combine_RF_results_list(g1_A1_sv_0.01_RF_results) %>%
combine_NN_results_list(g1_A1_sv_0.01_NN_results15, g1_A1_sv_0.01_NN_results610) %>%
combine_LSTM_results_list(g1_A1_sv_0.01_LSTM_results_15, 0) %>%
combine_FFORMA_results_list(g1_A1_sv_0.01_FFORMA_results)
g2_A1_sv_0.01_results_all <- g2_A1_sv_0.01_results %>%
combine_RF_results_list(g2_A1_sv_0.01_RF_results) %>%
combine_NN_results_list(g2_A1_sv_0.01_NN_results15, g2_A1_sv_0.01_NN_results610) %>%
combine_LSTM_results_list(g2_A1_sv_0.01_LSTM_results_15, 0) %>%
combine_FFORMA_results_list(g2_A1_sv_0.01_FFORMA_results)
g3_A1_sv_0.01_results_all <- g3_A1_sv_0.01_results %>%
combine_RF_results_list(g3_A1_sv_0.01_RF_results) %>%
combine_NN_results_list(g3_A1_sv_0.01_NN_results15, g3_A1_sv_0.01_NN_results610) %>%
combine_LSTM_results_list(g3_A1_sv_0.01_LSTM_results_15, 0) %>%
combine_FFORMA_results_list(g3_A1_sv_0.01_FFORMA_results)
## sv_0.1
g1_A1_sv_0.1_results_all <- g1_A1_sv_0.1_results %>%
combine_RF_results_list(g1_A1_sv_0.1_RF_results) %>%
combine_NN_results_list(g1_A1_sv_0.1_NN_results15, g1_A1_sv_0.1_NN_results610) %>%
combine_LSTM_results_list(g1_A1_sv_0.1_LSTM_results_15, 0) %>%
combine_FFORMA_results_list(g1_A1_sv_0.1_FFORMA_results)
g2_A1_sv_0.1_results_all <- g2_A1_sv_0.1_results %>%
combine_RF_results_list(g2_A1_sv_0.1_RF_results) %>%
combine_NN_results_list(g2_A1_sv_0.1_NN_results15, g2_A1_sv_0.1_NN_results610) %>%
combine_LSTM_results_list(g2_A1_sv_0.1_LSTM_results_15, 0) %>%
combine_FFORMA_results_list(g2_A1_sv_0.1_FFORMA_results)
g3_A1_sv_0.1_results_all <- g3_A1_sv_0.1_results %>%
combine_RF_results_list(g3_A1_sv_0.1_RF_results) %>%
combine_NN_results_list(g3_A1_sv_0.1_NN_results15, g3_A1_sv_0.1_NN_results610) %>%
combine_LSTM_results_list(g3_A1_sv_0.1_LSTM_results_15, 0) %>%
combine_FFORMA_results_list(g3_A1_sv_0.1_FFORMA_results)
## sv_1
g1_A1_sv_1_results_all <- g1_A1_sv_1_results %>%
combine_RF_results_list(g1_A1_sv_1_RF_results) %>%
combine_NN_results_list(g1_A1_sv_1_NN_results15, g1_A1_sv_1_NN_results610)%>%
combine_LSTM_results_list(g1_A1_sv_1_LSTM_results_15, 0) %>%
combine_FFORMA_results_list(g1_A1_sv_1_FFORMA_results)
g2_A1_sv_1_results_all <- g2_A1_sv_1_results %>%
combine_RF_results_list(g2_A1_sv_1_RF_results) %>%
combine_NN_results_list(g2_A1_sv_1_NN_results15, g2_A1_sv_1_NN_results610)%>%
combine_LSTM_results_list(g2_A1_sv_1_LSTM_results_15, 0) %>%
combine_FFORMA_results_list(g2_A1_sv_1_FFORMA_results)
g3_A1_sv_1_results_all <- g3_A1_sv_1_results %>%
combine_RF_results_list(g3_A1_sv_1_RF_results) %>%
combine_NN_results_list(g3_A1_sv_1_NN_results15, g3_A1_sv_1_NN_results610)%>%
combine_LSTM_results_list(g3_A1_sv_1_LSTM_results_15, 0) %>%
combine_FFORMA_results_list(g3_A1_sv_1_FFORMA_results)
saveRDS(g1_A1_nosv_0_results_all, file =
"~/GitHub/Evaluation-of-Machine-Learning-in-Asset-Pricing/R/Model_results/g1_A1_nosv_0_results_all.rds")
saveRDS(g2_A1_nosv_0_results_all, file =
"~/GitHub/Evaluation-of-Machine-Learning-in-Asset-Pricing/R/Model_results/g2_A1_nosv_0_results_all.rds")
saveRDS(g3_A1_nosv_0_results_all, file =
"~/GitHub/Evaluation-of-Machine-Learning-in-Asset-Pricing/R/Model_results/g3_A1_nosv_0_results_all.rds")
saveRDS(g1_A1_sv_0.01_results_all, file =
"~/GitHub/Evaluation-of-Machine-Learning-in-Asset-Pricing/R/Model_results/g1_A1_sv_0.01_results_all.rds")
saveRDS(g2_A1_sv_0.01_results_all, file =
"~/GitHub/Evaluation-of-Machine-Learning-in-Asset-Pricing/R/Model_results/g2_A1_sv_0.01_results_all.rds")
saveRDS(g3_A1_sv_0.01_results_all, file =
"~/GitHub/Evaluation-of-Machine-Learning-in-Asset-Pricing/R/Model_results/g3_A1_sv_0.01_results_all.rds")
saveRDS(g1_A1_sv_0.1_results_all, file =
"~/GitHub/Evaluation-of-Machine-Learning-in-Asset-Pricing/R/Model_results/g1_A1_sv_0.1_results_all.rds")
saveRDS(g2_A1_sv_0.1_results_all, file =
"~/GitHub/Evaluation-of-Machine-Learning-in-Asset-Pricing/R/Model_results/g2_A1_sv_0.1_results_all.rds")
saveRDS(g3_A1_sv_0.1_results_all, file =
"~/GitHub/Evaluation-of-Machine-Learning-in-Asset-Pricing/R/Model_results/g3_A1_sv_0.1_results_all.rds")
saveRDS(g1_A1_sv_1_results_all, file =
"~/GitHub/Evaluation-of-Machine-Learning-in-Asset-Pricing/R/Model_results/g1_A1_sv_1_results_all.rds")
saveRDS(g2_A1_sv_1_results_all, file =
"~/GitHub/Evaluation-of-Machine-Learning-in-Asset-Pricing/R/Model_results/g2_A1_sv_1_results_all.rds")
saveRDS(g3_A1_sv_1_results_all, file =
"~/GitHub/Evaluation-of-Machine-Learning-in-Asset-Pricing/R/Model_results/g3_A1_sv_1_results_all.rds")
gen_tidy_loss_df <- function(simulation_results_list, realization_no, dgp_spec, SV, cross_corr) {
df <- foreach(sample = (1:3), .combine = "rbind") %do% {
rbind(
cbind(model = "LM_MSE", sample = sample, simulation_results_list[[realization_no]]$LM_MSE[[sample]]$loss_stats),
cbind(model = "LM_MAE", sample = sample, simulation_results_list[[realization_no]]$LM_MAE[[sample]]$loss_stats),
################################################################################################
cbind(model = "ELN_MSE", sample = sample, simulation_results_list[[realization_no]]$ELN_MSE[[sample]]$loss_stats),
cbind(model = "ELN_MAE", sample = sample, simulation_results_list[[realization_no]]$ELN_MAE[[sample]]$loss_stats),
################################################################################################
cbind(model = "RF_MSE", sample = sample, simulation_results_list[[realization_no]]$RF_MSE[[sample]]$loss_stats),
cbind(model = "RF_MAE", sample = sample, simulation_results_list[[realization_no]]$RF_MAE[[sample]]$loss_stats),
################################################################################################
cbind(model = "NN1_MSE", sample = sample, simulation_results_list[[realization_no]]$NN1_MSE[[sample]]$loss_stats),
cbind(model = "NN1_MAE", sample = sample, simulation_results_list[[realization_no]]$NN1_MAE[[sample]]$loss_stats),
cbind(model = "NN2_MSE", sample = sample, simulation_results_list[[realization_no]]$NN2_MSE[[sample]]$loss_stats),
cbind(model = "NN2_MAE", sample = sample, simulation_results_list[[realization_no]]$NN2_MAE[[sample]]$loss_stats),
cbind(model = "NN3_MSE", sample = sample, simulation_results_list[[realization_no]]$NN3_MSE[[sample]]$loss_stats),
cbind(model = "NN3_MAE", sample = sample, simulation_results_list[[realization_no]]$NN3_MAE[[sample]]$loss_stats),
cbind(model = "NN4_MSE", sample = sample, simulation_results_list[[realization_no]]$NN4_MSE[[sample]]$loss_stats),
cbind(model = "NN4_MAE", sample = sample, simulation_results_list[[realization_no]]$NN4_MAE[[sample]]$loss_stats),
cbind(model = "NN5_MSE", sample = sample, simulation_results_list[[realization_no]]$NN5_MSE[[sample]]$loss_stats),
cbind(model = "NN5_MAE", sample = sample, simulation_results_list[[realization_no]]$NN5_MAE[[sample]]$loss_stats),
#################################################################################################
cbind(model = "LSTM_MSE", sample = sample, simulation_results_list[[realization_no]]$LSTM_MSE[[sample]]$loss_stats),
cbind(model = "LSTM_MAE", sample = sample, simulation_results_list[[realization_no]]$LSTM_MAE[[sample]]$loss_stats),
#################################################################################################
cbind(model = "FFORMA_MSE", sample = sample, simulation_results_list[[realization_no]]$FFORMA_MSE[[sample]]$loss_stats),
cbind(model = "FFORMA_MAE", sample = sample, simulation_results_list[[realization_no]]$FFORMA_MAE[[sample]]$loss_stats)
)
}
cbind(realization_no = realization_no, dgp_spec = dgp_spec, SV = SV, cross_corr = cross_corr, df)
}
all_realize_loss_df <- function(simulation_results_list, dgp_spec, SV, cross_corr) {
foreach(realization_no = (1:10), .combine = "rbind") %do% {
gen_tidy_loss_df(simulation_results_list, realization_no, dgp_spec, SV, cross_corr)
}
}
all_loss_df <- rbind(
all_realize_loss_df(g1_A1_nosv_0_results_all, dgp_spec = "g1", SV = 0, cross_corr = 0),
all_realize_loss_df(g2_A1_nosv_0_results_all, dgp_spec = "g2", SV = 0, cross_corr = 0),
all_realize_loss_df(g3_A1_nosv_0_results_all, dgp_spec = "g3", SV = 0, cross_corr = 0),
all_realize_loss_df(g1_A1_sv_0.01_results_all, dgp_spec = "g1", SV = 1, cross_corr = 0.01),
all_realize_loss_df(g2_A1_sv_0.01_results_all, dgp_spec = "g2", SV = 1, cross_corr = 0.01),
all_realize_loss_df(g3_A1_sv_0.01_results_all, dgp_spec = "g3", SV = 1, cross_corr = 0.01),
all_realize_loss_df(g1_A1_sv_0.1_results_all, dgp_spec = "g1", SV = 1, cross_corr = 0.1),
all_realize_loss_df(g2_A1_sv_0.1_results_all, dgp_spec = "g2", SV = 1, cross_corr = 0.1),
all_realize_loss_df(g3_A1_sv_0.1_results_all, dgp_spec = "g3", SV = 1, cross_corr = 0.1),
all_realize_loss_df(g1_A1_sv_1_results_all, dgp_spec = "g1", SV = 1, cross_corr = 1),
all_realize_loss_df(g2_A1_sv_1_results_all, dgp_spec = "g2", SV = 1, cross_corr = 1),
all_realize_loss_df(g3_A1_sv_1_results_all, dgp_spec = "g3", SV = 1, cross_corr = 1)
)
all_realize_loss_df <- function(simulation_results_list, dgp_spec, SV, cross_corr) {
foreach(realization_no = (1:10), .combine = "rbind") %do% {
gen_tidy_loss_df(simulation_results_list, realization_no, dgp_spec, SV, cross_corr)
}
}
all_realize_loss_df <- function(simulation_results_list, dgp_spec, SV, cross_corr) {
foreach(realization_no = (1:5), .combine = "rbind") %do% {
gen_tidy_loss_df(simulation_results_list, realization_no, dgp_spec, SV, cross_corr)
}
}
all_loss_df <- rbind(
all_realize_loss_df(g1_A1_nosv_0_results_all, dgp_spec = "g1", SV = 0, cross_corr = 0),
all_realize_loss_df(g2_A1_nosv_0_results_all, dgp_spec = "g2", SV = 0, cross_corr = 0),
all_realize_loss_df(g3_A1_nosv_0_results_all, dgp_spec = "g3", SV = 0, cross_corr = 0),
all_realize_loss_df(g1_A1_sv_0.01_results_all, dgp_spec = "g1", SV = 1, cross_corr = 0.01),
all_realize_loss_df(g2_A1_sv_0.01_results_all, dgp_spec = "g2", SV = 1, cross_corr = 0.01),
all_realize_loss_df(g3_A1_sv_0.01_results_all, dgp_spec = "g3", SV = 1, cross_corr = 0.01),
all_realize_loss_df(g1_A1_sv_0.1_results_all, dgp_spec = "g1", SV = 1, cross_corr = 0.1),
all_realize_loss_df(g2_A1_sv_0.1_results_all, dgp_spec = "g2", SV = 1, cross_corr = 0.1),
all_realize_loss_df(g3_A1_sv_0.1_results_all, dgp_spec = "g3", SV = 1, cross_corr = 0.1),
all_realize_loss_df(g1_A1_sv_1_results_all, dgp_spec = "g1", SV = 1, cross_corr = 1),
all_realize_loss_df(g2_A1_sv_1_results_all, dgp_spec = "g2", SV = 1, cross_corr = 1),
all_realize_loss_df(g3_A1_sv_1_results_all, dgp_spec = "g3", SV = 1, cross_corr = 1)
)
all_loss_df_averaged <- all_loss_df %>%
data.frame() %>%
group_by(model, dgp_spec, sample, SV, cross_corr) %>%
summarise(validation_MAE = mean(validation_MAE), validation_MSE = mean(validation_MSE),
validation_RMSE = mean(validation_RMSE), validation_RSquare = mean(validation_RSquare),
test_MAE = mean(test_MAE), test_MSE = mean(test_MSE),
test_RMSE = mean(test_RMSE), test_RSquare = mean(test_RSquare)
)
write.csv(all_loss_df_averaged, file = "~/GitHub/Evaluation-of-Machine-Learning-in-Asset-Pricing/Results/simulation_loss_averaged.csv")
write.csv(all_loss_df, file = "~/GitHub/Evaluation-of-Machine-Learning-in-Asset-Pricing/Results/simulation_loss.csv")
a4_aspect_ratio <- 1.5
################################################################
# Training Statistics
all_loss_df_averaged %>%
ungroup() %>%
mutate(sample = as.factor(sample)) %>%
ggplot() +
geom_bar(aes(x = model, y = train_MAE, fill = sample), stat = "identity", position = position_dodge()) +
theme_bw() +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
scale_fill_brewer(palette = "Paired") +
facet_grid(rows = vars(cross_corr), cols = vars(dgp_spec))
all_loss_df_averaged %>%
ungroup() %>%
mutate(sample = as.factor(sample)) %>%
ggplot() +
geom_bar(aes(x = model, y = test_RMSE, fill = sample), stat = "identity", position = position_dodge()) +
scale_x_discrete(label = labels, breaks = breaks) +
theme_bw() +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
scale_fill_brewer(palette = "Paired") +
facet_grid(rows = vars(cross_corr), cols = vars(dgp_spec))
breaks <- levels(all_loss_df_averaged$model)
labels <- as.expression(breaks)
## Plots showing that quantile loss is better
all_loss_df_averaged %>%
ungroup() %>%
mutate(sample = as.factor(sample)) %>%
ggplot() +
geom_bar(aes(x = model, y = test_MAE, fill = sample), stat = "identity", position = position_dodge()) +
scale_x_discrete(label = labels, breaks = breaks) +
theme_bw() +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
scale_fill_brewer(palette = "Paired") +
facet_grid(rows = vars(cross_corr), cols = vars(dgp_spec))
ggsave(filename = "~/GitHub/Evaluation-of-Machine-Learning-in-Asset-Pricing/Results/simulation_test_mae_pre_all.pdf",
width = 15 * a4_aspect_ratio, height = 15, units = "cm")
all_loss_df_averaged %>%
ungroup() %>%
mutate(sample = as.factor(sample)) %>%
ggplot() +
geom_bar(aes(x = model, y = test_MSE, fill = sample), stat = "identity", position = position_dodge()) +
scale_x_discrete(label = labels, breaks = breaks) +
theme_bw() +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
scale_fill_brewer(palette = "Paired") +
facet_grid(rows = vars(cross_corr), cols = vars(dgp_spec))
ggsave(filename = "~/GitHub/Evaluation-of-Machine-Learning-in-Asset-Pricing/Results/simulation_test_mse_pre_all.pdf",
width = 15 * a4_aspect_ratio, height = 15, units = "cm")
all_loss_df_averaged %>%
ungroup() %>%
mutate(sample = as.factor(sample)) %>%
ggplot() +
geom_bar(aes(x = model, y = test_RMSE, fill = sample), stat = "identity", position = position_dodge()) +
scale_x_discrete(label = labels, breaks = breaks) +
theme_bw() +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
scale_fill_brewer(palette = "Paired") +
facet_grid(rows = vars(cross_corr), cols = vars(dgp_spec))
ggsave(filename = "~/GitHub/Evaluation-of-Machine-Learning-in-Asset-Pricing/Results/simulation_test_rmse.pdf",
width = 15 * a4_aspect_ratio, height = 15, units = "cm")
all_loss_df_averaged %>%
ungroup() %>%
mutate(sample = as.factor(sample)) %>%
ggplot() +
geom_bar(aes(x = model, y = test_Rsquare, fill = sample), stat = "identity", position = position_dodge()) +
scale_x_discrete(label = labels, breaks = breaks) +
theme_bw() +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
scale_fill_brewer(palette = "Paired") +
facet_grid(rows = vars(cross_corr), cols = vars(dgp_spec))
all_loss_df_averaged %>%
ungroup() %>%
mutate(sample = as.factor(sample)) %>%
ggplot() +
geom_bar(aes(x = model, y = test_RSquare, fill = sample), stat = "identity", position = position_dodge()) +
scale_x_discrete(label = labels, breaks = breaks) +
theme_bw() +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
scale_fill_brewer(palette = "Paired") +
facet_grid(rows = vars(cross_corr), cols = vars(dgp_spec))
ggsave(filename = "~/GitHub/Evaluation-of-Machine-Learning-in-Asset-Pricing/Results/simulation_test_rsquare.pdf",
width = 15 * a4_aspect_ratio, height = 15, units = "cm")
