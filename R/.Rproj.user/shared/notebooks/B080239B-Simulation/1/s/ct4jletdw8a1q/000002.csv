"0","############################################################################"
"0","##Function to generate return series given specification of A and g function"
"0","############################################################################"
"0","gen_rt <- function(A, g){"
"0","  elp <- matrix(0, nrow = N, ncol = 1)"
"0","  "
"0","  rt <- rep(list(elp), Time+1)"
"0","  "
"0","  #########################"
"0","  Axt <- gen_xt(A)"
"0","  Beta <- gen_Beta()"
"0","  v <- gen_v()"
"0","  error <- gen_error()"
"0","  #########################"
"0","  "
"0","  for (t in 1:(Time)) {"
"0","    for (i in 1:N){"
"0","      rt[[t+1]][i] <- g(C, Axt, i, t, theta) + Beta[[t+1]][i, ] %*% v[[t+1]] + error[[t+1]][i]"
"0","    }"
"0","  }"
"0","  "
"0","  return(rt)"
"0","}"
