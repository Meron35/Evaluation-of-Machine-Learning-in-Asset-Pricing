"0","##########################"
"0","##Functions for elements in return equation"
"0","##########################"
"0","###########"
"0","##Function to generate Beta, i,t"
"0","###########"
"0","#Beta is the the first 3 rows of the specified characteristics vector"
"0","gen_Beta <- function(C){"
"0","  "
"0","  #Empty Matrix Init"
"0","  eln <- matrix(0, nrow = N, ncol = 3)"
"0","  Beta <- rep(list(eln), Time+1)"
"0","  "
"0","  for (t in 1:(Time+1)) {"
"0","    Beta[[t]] <- C[[t]][, 1:3]"
"0","  }"
"0","  return(Beta)"
"0","}"
"0","#Check"
"0","Beta <- gen_Beta(C)"
"0","###"
"0","##v error term"
"0","###"
"0","#This is is trivariate N(0, 0.05^2) series, constant across all stocks"
"0","v_sd <- 0.05"
"0","gu_gen_v <- function(v_sd){"
"0","  "
"0","  #Empty Matrix Init"
"0","  elo <- matrix(0, nrow = 3, ncol = 1)"
"0","  "
"0","  v <- rep(list(elo), Time+1)"
"0","  "
"0","  for (t in 1:(Time+1)) {"
"0","    v[[t]] <- matrix("
"0","      data = rnorm(3, 0, v_sd),"
"0","      nrow = 3, ncol = 1"
"0","    )"
"0","  }"
"0","  return(v)"
"0","}"
"0","#No SV error strucure for Gu et al, yay!"
"0","###"
"0","##Epsilon Term is N x 1 vector of idiosyncatic errors, distributed at students t with 5 dof (0, 0.05^2)"
"0","###"
"0","ep_sd <- 0.05"
"0","gu_gen_error <- function(ep_sd){"
"0","  "
"0","  error <- rep("
"0","    list("
"0","      matrix("
"0","        0, nrow = N, ncol = 1"
"0","      )"
"0","    ), Time+1"
"0","  )"
"0","  "
"0","  for (t in 1:Time+1){"
"0","    for (i in 1:N) {"
"0","      #This is how you build in a specified variance for student t"
"0","      error[[t]][i] <- rt(1, 5)*sqrt(ep_sd^2 * (5-2)/5)"
"0","    }"
"0","  }"
"0","  "
"0","  return(error)"
"0","}"
