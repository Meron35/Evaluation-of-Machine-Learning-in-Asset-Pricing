"0","########################"
"0","##xt set up"
"0","########################"
"0","########################"
"0","##Specify A Matrices"
"0","########################"
"0","A1 <- matrix(c("
"0","  0.95, 0, 0,"
"0","  0, 0.95, 0,"
"0","  0, 0, 0.95),"
"0","  nrow = 3, ncol = 3"
"0",")"
"0","A2 <- matrix(c("
"0","  1, 0, 0.25,"
"0","  0, 0.95, 0,"
"0","  0.25, 0, 0.95),"
"0","  nrow = 3, ncol = 3"
"0",")"
"0","A3 <- matrix(c("
"0","  0.99, 0.2, 0.1,"
"0","  0.2, 0.90, -0.3,"
"0","  0.1, -0.3, -0.99),"
"0","  nrow = 3, ncol = 3"
"0",")"
"0","###################################"
"0","###Function to Generate xt series"
"0","###################################"
"0","#xt is a multivariate time series with 3 different series"
"0","#Generates xt series, gien A matrix specification"
"0","gen_xt <- function(A){"
"0","  "
"0","  xt <- data.frame(x1 = c(0:Time),"
"0","                   x2 = c(0:Time),"
"0","                   x3 = c(0:Time)"
"0","  )"
"0","  "
"0","  Axt <- xt"
"0","  for (i in 1:(Time+1)) {"
"0","    ut <- rnorm(3, mean = 0, sd = 1)"
"0","    Axt[1+i,] <- Axt[i,] + ut"
"0","  }"
"0","  Axt <- Axt[-1,]"
"0","  return(Axt)"
"0","}"
"0","#########################################"
"0","##Function to plot xt"
"0","#########################################"
"0","#Transforms xt series to wide format to plot it"
"0","plot_xt <- function(xt){"
"0","  xt_tidy <- cbind(t = c(1:(Time+1)), xt)"
"0","  xt_tidy <- xt_tidy %>%"
"0","    gather(series, value, -t)"
"0","  "
"0","  ggplot(data = xt_tidy) +"
"0","    geom_line(aes(x = t, y = value, colour = series))"
"0","}"
