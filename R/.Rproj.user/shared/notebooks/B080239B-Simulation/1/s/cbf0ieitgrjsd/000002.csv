"0","#characteristics C"
"0","elm <- matrix("
"0","  data = 0, nrow = N, ncol = P_c"
"0",")"
"0","C_bar <- rep(list(elm), 181)"
"0","for (t in 1:180) {"
"0","  for (j in 1:P_c) {"
"0","    rho <- runif(1, 1/2, 1)"
"0","    for (i in 1:N) {"
"0","      C_bar[[t+1]][i, j] <- C_bar[[t]][i, j]*rho + rnorm(1, 0, 1)"
"0","    }"
"0","  }  "
"0","}"
"0","#Remove initial"
"0","C_bar[[1]] <- NULL"
"0","#B and lambda matrix"
"0","Lambda <- matrix("
"0","  data = rnorm(N*4, 0, 1),"
"0","  nrow = N, ncol = 4"
"0",")"
"0","B <- (Lambda)%*%t(Lambda)"
"0","B <- B + 1/10*diag(nrow = nrow(B))"
"0","#Transform into correlation matrix W"
"0","W <- diag(B)^(-1/2)*B*diag(B)^(-1/2)"
"0","C_hat <- rep(list(elm), 180)"
"0","for (t in 1:180) {"
"0","  C_hat[[t]] <- W %*% C_bar[[t]]"
"0","}"
"0","#Generate final ""observed"" C"
"0","C <- rep(list(elm), 180)"
"0","for (t in 1:180) {"
"0","  C[[t]] <- (2/(N*P_c+1))*("
"0","    rank(C_bar[[t]])"
"0","    ) - matrix("
"0","      data = 1, nrow = N, ncol = P_c"
"0","      )"
"0","}"
