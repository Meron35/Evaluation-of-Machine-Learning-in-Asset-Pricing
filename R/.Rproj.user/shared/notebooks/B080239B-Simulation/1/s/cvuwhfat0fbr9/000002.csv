"0","############################"
"0","##Different g() functions"
"0","############################"
"0","#Logit function, used in some specified structures"
"0","logit <- function(x){"
"0","  (1 + exp(-x))^(-1)"
"0","}"
"0","#Remmeber that theta needs to be tuned later. Set up all of the functions as functions of theta"
"0","#Code these up so that they can take either the trivariate xt or univariate xt series"
"0","##############################"
"0","#g1"
"0","##############################"
"0","#Default theta, 1x3 dimensions"
"0","theta <- matrix(c(0.02, 0.02, 0.02), nrow = 1)"
"0","g1 <- function(C, x, i, t, theta){"
"0","  #Univariate xt case"
"0","  if (ncol(x) == 1) {"
"0","    matrix(c("
"0","      C[i, 1, t], C[i, 2, t], C[i, 3, t] * x[t]"
"0","      ), nrow = 1) %*% t(theta)"
"0","  } "
"0","  #Multivariate Case"
"0","  else {"
"0","    matrix(c("
"0","      C[i, 1, t], C[i, 2, t], C[i, 3, t] * t(x[t, 3])"
"0","      ), nrow = 1) %*% t(theta)"
"0","  }"
"0","}"
"0","#test if working"
"0","g1(C, xt_univariate, 1, 1, theta)"
"1","    "
"1","       [,1]"
"1","
[1,]"
"1"," 0.01509964"
"1","
"
"0","g1(C, xt, 1, 1, theta)"
"1","    "
"1","       [,1]"
"1","
[1,]"
"1"," 0.01287861"
"1","
"
"0","##############################"
"0","#g2"
"0","##############################"
"0","#Default theta, 1x3 dimensions"
"0","theta <- matrix(c(0.04, 0.035, 0.01), nrow = 1)"
"0","g2 <- function(C, x, i, t, theta){"
"0","  #Univariate Case"
"0","  if (ncol(x) == 1) {"
"0","    matrix(c("
"0","      C[i, 1, t]^2, "
"0","      C[i, 1, t]*C[i, 2, t],"
"0","      sign("
"0","        C[i, 3, t] * x[t]"
"0","        )"
"0","    ), nrow = 1) %*% t(theta)"
"0","  }"
"0","  #Multivariate Case"
"0","  else {"
"0","    matrix(c("
"0","      C[i, 1, t]^2, "
"0","      C[i, 1, t]*C[i, 2, t],"
"0","      sign("
"0","        C[i, 3, t] * t(x[t, 3])"
"0","        )"
"0","    ), nrow = 1) %*% t(theta)"
"0","  }"
"0","}"
"0","#test if working"
"0","g2(C, xt_univariate, 1, 1, theta)"
"1","    "
"1","       [,1]"
"1","
[1,]"
"1"," 0.01580048"
"1","
"
"0","g2(C, xt, 1, 1, theta)"
"1","    "
"1","       [,1]"
"1","
[1,]"
"1"," 0.01580048"
"1","
"
"0","#############################"
"0","#g3"
"0","#############################"
"0","#Default theta, 1x4 dimensions"
"0","theta <- matrix(c(0.04, 0.035, 0.01, 0.01), nrow = 1)"
"0","g3 <- function(C, x, i, t, theta){"
"0","  #g3 does not care about xt series. Should work regardless"
"0","  matrix("
"0","    c("
"0","      (C[i, 1, t] > 0), "
"0","      C[i, 2, t]^3,"
"0","      C[i, 1, t] * C[i, 2, t] * (C[i, 3, t] > 0),"
"0","      logit(C[i, 3, t])"
"0","      ),"
"0","    nrow = 1) %*% t(theta)"
"0","}"
"0","#test if working"
"0","g3(C, xt, 1, 1, theta)"
"1","    "
"1","       [,1]"
"1","
[1,]"
"1"," 0.04510265"
"1","
"
"0","#################################"
"0","#g4"
"0","#Remember that we are supposed to pass C hat through to g4"
"0","#################################"
"0","#Default theta, 1x3 dimensions"
"0","theta <- matrix(c(0.02, 0.02, 0.02), nrow = 1)"
"0","g4 <- function(C, x, i, t, theta){"
"0","  #Univariate"
"0","  if (ncol(x) == 1) {"
"0","    matrix(c("
"0","      C[i, 1, t],"
"0","      C[i, 2, t],"
"0","      C[i, 3, t] * x[t]"
"0","      ), nrow = 1"
"0","    ) %*% t(theta)"
"0","  } "
"0","  #Multivariate"
"0","  else {"
"0","    matrix(c("
"0","      C[i, 1, t],"
"0","      C[i, 2, t],"
"0","      C[i, 3, t] * t(x[t, 3])"
"0","      ), nrow = 1"
"0","    ) %*% t(theta)"
"0","  }"
"0","}"
"0","#test if working"
"0","g4(C_hat, xt_univariate, 1, 1, theta)"
"1","    "
"1","       [,1]"
"1","
[1,]"
"1"," 0.05131735"
"1","
"
"0","g4(C_hat, xt, 1, 1, theta)"
"1","    "
"1","       [,1]"
"1","
[1,]"
"1"," 0.04292998"
"1","
"
"0","#################################"
